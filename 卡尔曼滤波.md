# 卡尔曼滤波 kalman filter

卡尔曼滤波是一种最优化的、递归的、数字处理的算法。

optimal recursive data processing algorithm

它更像是一种优化器而不是一种滤波器

卡尔曼滤波器的应用十分广泛，因为我们的生活中存在着大量的不确定性

不确定性表现在：不存在完美的数学模型，系统的扰动不可控很难建模，测量传感器存在误差

## 第一部分.递归算法 recursive algorithm

### 先举一个抛硬币的列子  

假设测量一个硬币的直径，每次测量存在误差，为了减小误差采用平均值估计的方法

![image-20241126203310303](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126203310303.png)

随着测量次数的增加，本次测量的结果也就不再重要了，当测量结果比较小时测量结果比较重要

重新改写一下可以写为：

![image-20241126203735972](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126203735972.png)

卡尔曼滤波与这个例子很相似

本次的估计值与上一次有关，上一次的估计值与上上次有关，这是递归的思想，并且不用追溯很远这是卡尔曼滤波器的优势。

在卡尔曼滤波器中K_k叫做卡尔曼增益



### 初探卡尔曼滤波

为了理解卡尔曼增益先引入两个概念：

估计误差：估计值与真实值的误差

测量误差：测量值与真实值的差距

![image-20241126204612769](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126204612769.png)

卡尔曼增益等于第k-1次时的估计误差除以（第k-1次时的估计误差加第k次时的测量误差）

来看一下误差对估计值的影响

![image-20241126205205824](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126205205824.png)

如果上一次估计误差比这一次的测量误差大，则本次的估计值更偏向于测量值

如果上一次估计误差比这一次的测量误差小，则本次的估计值更偏向于上一次的估计值

我们可以用这些公式简单应用卡尔曼滤波了

卡尔曼滤波应用分为三步，先计算卡尔曼增益，然后进行预测，最后更新估计误差

估计误差的来源之后推导。

注：卡尔曼滤波假设你不知道真实值

![image-20241126205841463](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126205841463.png)

还是拿测量硬币举例

第0次的估计误差和估计值是随便给的。

![image-20241126211426498](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126211426498.png)

剩下交给excel

![image-20241126212042826](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126212042826.png)

## 第二部分.数学基础 数据融合 协方差矩阵 状态空间方程 观测器

### 数据融合 data fusion

举个例子

用两个称，称一个东西，两个称都有误差，都服从高斯分布（正态分布）

![image-20241126212711957](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126212711957.png)

使用卡尔曼滤波的思想融合两个称的数据，使融合后的数据方差更小

因为两个称，所以两个称的数据相互独立

![image-20241126214133721](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126214133721.png)

### 协方差矩阵

举个例子

球员的身高、体重、年龄，计算平均数，方差，协方差

若两个两个值相差都是正的那乘起来也是正的，若两个值相差都是负的那乘起来也是正的

协方差为正说明两个变量变化方向相同，协方差为负说明两个变量变化方向相反 

比如身高变高，体重也相应增大，身高大于平均值，体重一般也大于平均值。

协方差矩阵就是把方差、协方差写成矩阵形式。这样可以很方便分析数据的关系了。

![image-20241126215247148](D:\github\卡尔曼滤波\卡尔曼滤波.assets\image-20241126215247148.png)